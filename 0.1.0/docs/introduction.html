<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="generator" content="Publish.jl" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="" />
    <title>FastAI.jl</title>
    <link rel="stylesheet" href="..&#x2F;normalize.css" />
    <link rel="stylesheet" href="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;katex@0.12.0&#x2F;dist&#x2F;katex.min.css" />
    <link rel="stylesheet" href="..&#x2F;tabulator_simple.min.css" />
    <link rel="stylesheet" href="..&#x2F;publish.css" />
    <link rel="stylesheet" href="..&#x2F;default.min.css" />
    <link rel="stylesheet" href="..&#x2F;custom.css" />
    <script src="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;katex@0.12.0&#x2F;dist&#x2F;katex.min.js"></script>
    <script src="https:&#x2F;&#x2F;cdn.jsdelivr.net&#x2F;npm&#x2F;katex@0.12.0&#x2F;dist&#x2F;contrib&#x2F;auto-render.min.js"></script>
    <script src="..&#x2F;versions.js"></script>
    <script src="..&#x2F;lunr.js"></script>
    <script src="..&#x2F;highlight.min.js"></script>
    <script src="..&#x2F;tabulator.min.js"></script>
    <script src="..&#x2F;julia.min.js"></script>
    <script src="..&#x2F;julia-repl.min.js"></script>
    <script src="..&#x2F;publish.js"></script>
    
</head>
<body>
    <main id="page">
        <div class="menu">
            <div id="projectname">FastAI.jl</div>
            <input id="search-input" placeholder="Search">
            <select id="version-selector"></select>
            <svg id="menu-toggler" title="Contents" onclick="toggleIndexPage();" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor" /><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor" /><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor" /></svg>
        </div>
        <div id="toc"><ul>
<li><a href="../README.html">README</a></li>
<li><a href="../docs/setup.html">Setup</a></li>
<li><a href="../docs/quickstart.html">Quickstart</a></li>
</ul>
<h1 id="tutorials"><a href="../#tutorials" class="anchor"></a>Tutorials</h1>
<ul>
<li><a href="../docs/introduction.html">Introduction</a></li>
<li><a href="../docs/data_containers.html">Data containers</a></li>
<li><a href="../docs/learning_methods.html">Learning methods</a></li>
</ul>
<h1 id="learning-tasks"><a href="../#learning-tasks" class="anchor"></a>Learning tasks</h1>
<ul>
<li><a href="../docs/methods/imageclassification.html">Image classification</a></li>
</ul>
<h1 id="how-to"><a href="../#how-to" class="anchor"></a>How To</h1>
<ul>
<li><a href="../docs/notebooks/fitonecycle.html">Train a model from scratch</a></li>
<li><a href="../docs/notebooks/fitonecycle.html">Finetune a pretrained model</a></li>
<li><a href="../docs/notebooks/lrfind.html">Find a good learning rate</a></li>
</ul>
<h1 id="reference"><a href="../#reference" class="anchor"></a>Reference</h1>
<ul>
<li><a href="../docstrings.html">Docstrings</a></li>
<li><a href="../docs/interfaces.html">Interfaces</a></li>
<li><a href="../docs/glossary.html">Glossary</a></li>
</ul>
<h1 id="background"><a href="../#background" class="anchor"></a>Background</h1>
<ul>
<li><a href="../background/datapipelines.html">Performant data pipelines</a></li>
</ul>
</div>
        <article id="content"><h1 id="introduction"><a href="#introduction" class="anchor"></a>Introduction</h1>
<p><em>This tutorial explains the qickstart examples and some core abstractions FastAI.jl is built on.</em></p>
<pre><code style="display:none;" cell="main" result="false" class="language-julia">using FastAI
using FastAI: Datasets
</code></pre>
<p>On the <a href="quickstart.ipynb">quickstart page</a>, we showed how to train models on common tasks in a few lines of code:</p>
<pre><code class="language-julia">dataset = Datasets.loaddataset(&quot;imagenette2-160&quot;)
method = ImageClassification(Datasets.loadclasses(&quot;imagenette2-160&quot;), (224, 224))
dls = methoddataloaders(dataset, method)
model = methodmodel(method, Models.xresnet18())
learner = Learner(model, dls, ADAM(), methodlossfn(method), ToGPU(), Metrics(accuracy))
fit!(learner, 10)
</code></pre>
<p>Let’s unpack each line.</p>
<h2 id="data-containers"><a href="#data-containers" class="anchor"></a>Data containers</h2>
<pre><code cell="main" class="language-julia">dataset = Datasets.loaddataset(&quot;imagenette2-160&quot;)
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:loaddataset))</code></pre>
<p>This line downloads and loads the <a href="">ImageNette</a> image classification dataset, a small subset of ImageNet with 10 different classes. <code>dataset</code> is a <a href="data_containers.html">data container</a> that can be used to load individual observations, here of images and the corresponding labels. We can use <code>getobs(dataset, i)</code> to load the <code>i</code>-th observation and <code>nobs</code> to find out how many observations there are.</p>
<pre><code cell="main" result="false" class="language-julia">image, class = getobs(dataset, 1000)
</code></pre>
<pre><code style="display:none" cell="main" class="language-julia">@show class
image
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:class))</code></pre>
<pre><code cell="main" class="language-julia">nobs(dataset)
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:dataset))</code></pre>
<p>To train on a different dataset, you could replace <code>dataset</code> with other data containers made up of pairs of images and classes.</p>
<h2 id="method"><a href="#method" class="anchor"></a>Method</h2>
<pre><code cell="main" class="language-julia">classes = Datasets.loadclasses(&quot;imagenette2-160&quot;)
method = ImageClassification(classes, (224, 224))
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:loadclasses))</code></pre>
<p>Here we define <a href="../docstrings/FastAI.ImageClassification.html"><code>ImageClassification</code></a>, which defines how data is processed before being fed to the model and how model outputs are turned into predictions. <code>classes</code> is a vector of strings naming each class, and <code>(224, 224)</code> the size of the images that are input to the model.</p>
<p><code>ImageClassification</code> is a <code>LearningMethod</code>, an abstraction that encapsulates the logic and configuration for training models on a specific learning task. See <a href="learning_methods.html">learning methods</a> to find out more about how they can be used and how to create custom learning methods.</p>
<h2 id="data-loaders"><a href="#data-loaders" class="anchor"></a>Data loaders</h2>
<pre><code cell="main" class="language-julia">dls = methoddataloaders(dataset, method, 16)
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:dataset))</code></pre>
<p>Next we turn the data container into training and validation data loaders. These take care of efficiently loading batches of data (by default in parallel). The observations are already preprocessed using the information in <code>method</code> and then batched together. Let’s look at a single batch:</p>
<pre><code cell="main" class="language-julia">traindl, valdl = dls
(xs, ys), _ = iterate(traindl)
summary.((xs, ys))
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:dls))</code></pre>
<p><code>xs</code> is a batch of cropped and normalized images with dimensions <code>(height, width, color channels, batch size)</code> and <code>ys</code> a batch of one-hot encoded classes with dimensions <code>(classes, batch size)</code>.</p>
<h2 id="model"><a href="#model" class="anchor"></a>Model</h2>
<pre><code cell="main" class="language-julia">model = methodmodel(method, Models.xresnet18())
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:method))</code></pre>
<p>Now we create a Flux.jl model. <code>methodmodel</code> is a part of the learning method interface that knows how to smartly construct an image classification model from different backbone architectures. Here a classficiation head with the appropriate number of classes is stacked on a slightly modified version of the ResNet architecture.</p>
<h2 id="learner"><a href="#learner" class="anchor"></a>Learner</h2>
<pre><code cell="main" class="language-julia">learner = Learner(model, dls, ADAM(), methodlossfn(method), ToGPU(), Metrics(accuracy))
</code></pre>
<pre><code class="plaintext cell-output cell-result" class="language-plaintext">LoadError(&quot;string&quot;, 1, UndefVarError(:method))</code></pre>
<p>Finally we bring the model and data loaders together with an optimizer and loss function in a <code>Learner</code>. The <code>Learner</code> stores all state for training the model. It also features a powerful, extensible <a href="https://lorenzoh.github.io/FluxTraining.jl/dev/docs/callbacks/reference.html">callback system</a> enabling checkpointing, hyperparameter scheduling, TensorBoard logging, and many other features. Here we use the <code>ToGPU()</code> callback so that model and batch data will be transferred to an available GPU and <code>Metrics(accuracy)</code> to track the classification accuracy during training.</p>
<p>With that setup, training <code>learner</code> is dead simple:</p>
<pre><code class="language-julia">fitonecycle!(learner, 5)
</code></pre>
</article>
        <div id="page-navigation">
            <a id="previous-page" title="Previous" href="quickstart.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.2426 6.34317L14.8284 4.92896L7.75739 12L14.8285 19.0711L16.2427 17.6569L10.5858 12L16.2426 6.34317Z" fill="currentColor" /></svg></a>
            <a id="next-page" title="Next" href="data_containers.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5858 6.34317L12 4.92896L19.0711 12L12 19.0711L10.5858 17.6569L16.2427 12L10.5858 6.34317Z" fill="currentColor" /></svg></a>
        </div>
        <footer>
            Built with <a target="_blank" href="https://github.com/MichaelHatherly/Publish.jl">Publish.jl</a> and the <a target="_blank" href="https://julialang.org">Julia Language</a>.
        </footer>
    </main>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {
            renderMathInElement(document.body, {
                delimiters: [
                    {left: "$$", right: "$$", display: true},
                    {left: "$", right: "$", display: false},
                    {left: "\\(", right: "\\)", display: false},
                    {left: "\\[", right: "\\]", display: true}
                ]
            });
        });
    </script>
</body>
</html>
