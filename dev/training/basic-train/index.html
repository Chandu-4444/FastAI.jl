<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic Train · FastAI.jl</title><link rel="canonical" href="https://FluxML.github.io/FastAI.jl/training/basic-train/"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">FastAI.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../getting-started/">Getting Started</a></li><li><span class="tocitem">Training</span><ul><li><a class="tocitem" href="../training/">Overview</a></li><li class="is-active"><a class="tocitem" href>Basic Train</a><ul class="internal"><li><a class="tocitem" href="#Learner"><span><code>Learner</code></span></a></li><li><a class="tocitem" href="#AbstractLearner-Interface"><span><code>AbstractLearner</code> Interface</span></a></li><li><a class="tocitem" href="#Recorder"><span><code>Recorder</code></span></a></li></ul></li></ul></li><li><span class="tocitem">Core</span><ul><li><a class="tocitem" href="../../core/core/">Overview</a></li><li><a class="tocitem" href="../../core/torch-core/">Torch Core</a></li><li><a class="tocitem" href="../../core/basic-data/">Basic Data</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Training</a></li><li class="is-active"><a href>Basic Train</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic Train</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/FluxML/FastAI.jl/blob/master/docs/src/training/basic-train.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Basic-Training-Functionality"><a class="docs-heading-anchor" href="#Basic-Training-Functionality">Basic Training Functionality</a><a id="Basic-Training-Functionality-1"></a><a class="docs-heading-anchor-permalink" href="#Basic-Training-Functionality" title="Permalink"></a></h1><p>Basic training wraps together the data (in a <a href="../../core/basic-data/#FastAI.DataBunch"><code>DataBunch</code></a> object) with a Flux model to define a <a href="#FastAI.Learner"><code>Learner</code></a> object. The <code>Learner</code> object is the entry point of most of the <a href="training/@ref Callbacks">Callback</a> objects that will customize this training loop in different ways.</p><p>&lt;!– from fastai docs</p><p>Some of the most commonly used customizations are available through the train module, notably:</p><p>Learner.lr<em>find will launch an LR range test that will help you select a good learning rate. Learner.fit</em>one<em>cycle will launch a training using the 1cycle policy to help you train your model faster. Learner.to</em>fp16 will convert your model to half precision and help you launch a training in mixed precision. –&gt;</p><h2 id="Learner"><a class="docs-heading-anchor" href="#Learner"><code>Learner</code></a><a id="Learner-1"></a><a class="docs-heading-anchor-permalink" href="#Learner" title="Permalink"></a></h2><p>A <a href="#FastAI.Learner"><code>Learner</code></a> type wraps a <a href="../../core/basic-data/#FastAI.DataBunch"><code>DataBunch</code></a> with a model and optimizer. The model can then be <a href="training/@ref"><code>fit</code></a> using the optimizer by training it for several epochs. The training process is customized by adding <a href="training/@ref">Callbacks</a> to the <code>Learner</code>.</p><article class="docstring"><header><a class="docstring-binding" id="FastAI.Learner" href="#FastAI.Learner"><code>FastAI.Learner</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Learner &lt;: AbstractLearner
Learner(data_bunch, model; opt = Flux.ADAM(), loss = Flux.mse)</code></pre><p>A <code>Learner</code> is the standard grouping of a data bunch, model, optimizer, and loss.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL95-L100">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FastAI.add_cb!" href="#FastAI.add_cb!"><code>FastAI.add_cb!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">add_cb!(learner::Learner, cb::AbstractCallback)</code></pre><p>Add <code>cb</code> to the list of callbacks for <code>learner</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL162-L166">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>cbs</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="FastAI.data_bunch" href="#FastAI.data_bunch"><code>FastAI.data_bunch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">data_bunch(l::Learner)</code></pre><p>Get the data bunch for <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL110-L114">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>data_bunch!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="FastAI.model" href="#FastAI.model"><code>FastAI.model</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">model(l::Learner)</code></pre><p>Get the model for <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL123-L127">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>model!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="FastAI.loss" href="#FastAI.loss"><code>FastAI.loss</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">loss(l::Learner)</code></pre><p>Get the loss for <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL136-L140">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FastAI.loss!" href="#FastAI.loss!"><code>FastAI.loss!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">loss!(l::Learner, loss)</code></pre><p>Set the loss for <code>l</code> to <code>loss</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL142-L146">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FastAI.opt" href="#FastAI.opt"><code>FastAI.opt</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">opt(l::Learner)</code></pre><p>Get the optimizer for <code>l</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL149-L153">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="FastAI.opt!" href="#FastAI.opt!"><code>FastAI.opt!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">opt!(l::Learner, opt)</code></pre><p>Set the optimizer for <code>l</code> to <code>opt</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL155-L159">source</a></section></article><h2 id="AbstractLearner-Interface"><a class="docs-heading-anchor" href="#AbstractLearner-Interface"><code>AbstractLearner</code> Interface</a><a id="AbstractLearner-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#AbstractLearner-Interface" title="Permalink"></a></h2><p>If you want to create a custom learner, you can implement the <a href="#FastAI.AbstractLearner"><code>AbstractLearner</code></a> interface.</p><article class="docstring"><header><a class="docstring-binding" id="FastAI.AbstractLearner" href="#FastAI.AbstractLearner"><code>FastAI.AbstractLearner</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">AbstractLearner</code></pre><p>An <code>AbstractLearner</code> groups together a model, train and validate data,   optimizer, loss function and callbacks.</p><p><a href="training/@ref">Callbacks</a> are used for every tweak of the training loop. Callbacks receive epoch, batch and loss information which they may pass on to <a href="training/@ref">Metrics</a>.</p><p><strong>Require interface</strong></p><ul><li><code>data_bunch(l::AbstractLearner)</code></li><li><code>data_bunch!(l::AbstractLearner, data_bunch)</code></li><li><code>model(l::AbstractLearner)</code></li><li><code>model!(l::AbstractLearner, model)</code></li><li><code>loss(l::AbstractLearner)</code></li><li><code>loss!(l::AbstractLearner, loss)</code></li><li><code>opt(l::AbstractLearner)</code></li><li><code>opt!(l::AbstractLearner, opt)</code></li><li><code>add_cb!(learner::AbstractLearner, cb::AbstractCallback)</code></li><li><code>cbs(learner::AbstractLearner)</code></li><li><code>fit!(learner::AbstractLearner, epoch_count)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/learner.jl#LL71-L92">source</a></section></article><h2 id="Recorder"><a class="docs-heading-anchor" href="#Recorder"><code>Recorder</code></a><a id="Recorder-1"></a><a class="docs-heading-anchor-permalink" href="#Recorder" title="Permalink"></a></h2><p>A <a href="#FastAI.Recorder"><code>Recorder</code></a> logs the values of metrics throughout the training history.</p><article class="docstring"><header><a class="docstring-binding" id="FastAI.Recorder" href="#FastAI.Recorder"><code>FastAI.Recorder</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">Recorder
Recorder(learn::Learner; train_loss = true, train_smooth_loss = true,
                         validate_loss = true, validate_smooth_loss = true)</code></pre><p>Container for <a href="#FastAI.Learner"><code>Learner</code></a> statistics (e.g. lr, loss and metrics) during training. Statistics are indexed by name, epoch and batch. For example to get the smoothed training loss for epoch 2, batch 3, we would call</p><pre><code class="language-julia">recorder[&quot;TrainSmoothLoss&quot;, 2, 3]</code></pre><p>To get the entire history of smooth training loss, one would call</p><pre><code class="language-julia">recorder[&quot;TrainSmoothLoss&quot;, :, :]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/FluxML/FastAI.jl/blob/dbfd7be026c99b25668b42b1234cc1daadfeac7b/src/recorder.jl#LL31-L46">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>add!(::Recorder, ::Any, ::Any, ::Any)</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>log!</code>. Check Documenter&#39;s build log for details.</p></div></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../training/">« Overview</a><a class="docs-footer-nextpage" href="../../core/core/">Overview »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 18 August 2020 18:35">Tuesday 18 August 2020</span>. Using Julia version 1.5.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
